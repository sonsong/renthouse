<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hss.renthouse.admins.bill.dao.BillMapper">

	<!-- 查询所有租金 -->
	<resultMap type="bill" id="getbillsResultMap">
		<id column="bid" property="bid" />
		<result column="btime" property="btime" />
		<result column="bdue" property="bdue" />
		<result column="bprice" property="bprice" />
		<result column="isPay" property="isPay" />
		<association property="user" javaType="user">
			<id column="uid" property="uid" />
			<result column="uname" property="uname" />
			<result column="uemail" property="uemail" />
		</association>
	</resultMap>
	<select id="queryAllBills" parameterType="bQueryVo" resultMap="getbillsResultMap">
		SELECT 
		b.bid, b.btime, b.bdue, b.bprice,
		case b.bstate
		when 0 then '未支付'
		else '已支付' end as isPay,
		u.uid, u.uname, u.uemail
		from t_bill b 
		inner join t_user u on b.uid = u.uid
		order by
		#{sort}
		#{sortOrder}
		limit #{offset}, #{ps}
	</select>
	<!-- 查询账单总数 -->
	<select id="queryBillsTotal" resultType="integer">
		select count(*) from
		t_bill
	</select>

	<!-- 新增账单记录 -->
	<insert id="addBill" parameterType="bill">
		insert into t_bill
		values
		(
		#{bid}, #{btime}, #{bprice}, #{bdue}, #{uid}, #{bstate} 
		)
	</insert>
</mapper> 